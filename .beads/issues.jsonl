{"id":"bd-1","title":"beads.el: Magit-like Emacs interface for Beads","description":"Build an Emacs Lisp package that provides a Magit-like porcelain interface for Beads issue tracking. The package should live in the lisp/ directory and provide an intuitive, keyboard-driven UI for working with Beads issues directly from Emacs.\n\nKey features:\n- Status buffer showing issues by status (open, in_progress, blocked, closed)\n- Keyboard shortcuts for common operations (create, update, close, show details)\n- Integration with existing beads CLI via subprocess calls\n- Transient menus for complex operations (similar to Magit's interface)\n- Jump to issue definitions in code\n- Inline editing of issue fields\n- Dependency visualization\n- Integration with Emacs project.el for multi-project support\n\nThis will make Beads more accessible to Emacs users and provide a seamless workflow for AI-supervised coding within the editor.","design":"## Architecture\n\n### Transient Menu System\n- Root transient menu accessible via M-x beads\n- Hierarchical menu structure following Magit patterns\n- All bd CLI commands exposed with full flag/argument support\n- Uses Emacs transient library for interactive menus\n\n### List Display Mode\nCommands that display lists of items should use Emacs tabulated-list-mode:\n- **bd list** - List of issues in tabulated format\n- **bd ready** - Ready work shown in tabulated format\n- **bd blocked** - Blocked issues in tabulated format\n- **bd stats** - Statistics displayed in tabulated format (where applicable)\n- **bd dep list** - Dependencies shown in tabulated format\n\nInterface similar to M-x proced:\n- Sortable columns (click headers to sort)\n- Keyboard navigation (n/p for next/prev)\n- Actions on current item (RET to show details, u to update, c to close, etc.)\n- Refresh capability (g to refresh)\n- Mark/unmark items for batch operations\n- Filter/narrow functionality\n\n### Buffer Organization\n- *beads-status* - Main status buffer (like magit-status)\n- *beads-list* - Issue list buffer (tabulated-list-mode)\n- *beads-ready* - Ready work buffer (tabulated-list-mode)\n- *beads-blocked* - Blocked issues buffer (tabulated-list-mode)\n- *beads-show: \u003cid\u003e* - Issue detail buffers\n- *beads-output* - Command output/results buffer\n\n### Integration Points\n- Uses bd CLI via process calls (call-process, start-process)\n- JSON output parsing for structured data\n- project.el integration for multi-project support\n- Auto-refresh after mutations (create, update, close, etc.)","acceptance_criteria":"### Core Transient Menu System\n- [ ] Main entry point: M-x beads (or custom keybinding) opens root transient menu\n- [ ] Root menu shows all available bd commands organized hierarchically\n- [ ] Navigation through menu hierarchy matches Magit UX patterns\n- [ ] All transient menus use the Emacs transient library\n\n### Command Coverage (100% of bd CLI)\nEvery bd command must be accessible via transient menus with full option support:\n\n- [ ] **init** - Initialize bd in directory\n  - Flags: --prefix, --db path\n  \n- [ ] **create** - Create new issue\n  - Arguments: title (required)\n  - Flags: -t/--type, -p/--priority, -d/--description, --id, --deps, --json\n  \n- [ ] **list** - List issues\n  - Flags: --status, --type, --priority, --format, --json\n  \n- [ ] **show** - Show issue details\n  - Arguments: issue-id (required)\n  - Flags: --json\n  \n- [ ] **update** - Update issue\n  - Arguments: issue-id (required)\n  - Flags: --status, --priority, --type, --title, --acceptance-criteria, --design, --notes, --assignee, --external-ref, --json\n  \n- [ ] **close** - Close issues\n  - Arguments: issue-id(s) (required)\n  - Flags: --reason, --json\n  \n- [ ] **ready** - Show ready work\n  - Flags: --json\n  \n- [ ] **blocked** - Show blocked issues\n  - Flags: --json\n  \n- [ ] **stats** - Show statistics\n  - Flags: --json\n  \n- [ ] **dep** - Dependency management (submenu)\n  - [ ] dep add - Add dependency\n    - Arguments: from-id, to-id (required)\n    - Flags: --type, --json\n  - [ ] dep remove - Remove dependency\n    - Arguments: from-id, to-id (required)\n    - Flags: --json\n  - [ ] dep tree - Show dependency tree\n    - Arguments: issue-id (required)\n    - Flags: --json\n  - [ ] dep list - List dependencies\n    - Arguments: issue-id (required)\n    - Flags: --json\n    \n- [ ] **export** - Export to JSONL\n  - Flags: -o/--output, --json\n  \n- [ ] **import** - Import from JSONL\n  - Flags: -i/--input, --dry-run, --resolve-collisions, --json\n\n### Global Flags Support\n- [ ] All commands support global flags: --actor, --db, --json, --no-auto-flush, --no-auto-import\n- [ ] Transient menu allows setting global flags before command execution\n- [ ] Settings persist within Emacs session\n\n### User Experience\n- [ ] Transient menus show current flag/option values\n- [ ] Help text displays for each option (like Magit's inline help)\n- [ ] Validation for required arguments before command execution\n- [ ] Command output displayed in dedicated buffer\n- [ ] Error messages clearly shown\n- [ ] Success feedback with option to refresh status buffer\n\n### Testing\n- [ ] Manual testing of all commands via transient menus\n- [ ] Verification that all flags/options work correctly\n- [ ] Edge cases (missing required args, invalid values) handled gracefully","notes":"## Implementation Notes\n\n### Issue Detail Display\nWhen showing the full content of an issue (via 'bd show' or when pressing RET on an issue in a list), consider using markdown-mode for rendering:\n\n- Issue fields (description, acceptance criteria, design, notes) often contain markdown\n- markdown-mode provides syntax highlighting and makes content more readable\n- Could create a custom derived mode (beads-show-mode) that inherits from markdown-mode\n- Add special keybindings on top of markdown-mode for beads-specific actions (edit field, update status, etc.)\n\nResearch needed:\n- How to make certain sections read-only while allowing inline editing of specific fields\n- Integration between markdown-mode's features and beads commands\n- Whether to use org-mode instead for better structured editing\n- How to display metadata (status, priority, dates) alongside markdown content\n\nAlternative: Use special-mode with custom fontification rules instead of markdown-mode if we need more control over the display and interaction model.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-10-14T22:07:04.599560014+02:00","updated_at":"2025-10-14T23:51:39.021986451+02:00","closed_at":"2025-10-14T23:51:39.021986451+02:00"}
{"id":"bd-2","title":"beads.el: Core package infrastructure and utilities","description":"Set up the foundational infrastructure for beads.el package.\n\nTasks:\n- Create lisp/ directory structure\n- Set up beads.el main file with package metadata\n- Implement bd CLI process wrapper functions (sync and async)\n- Add JSON parsing utilities for bd command output\n- Implement project.el integration for finding .beads directory\n- Add error handling and logging utilities\n- Create customization group for user settings\n- Set up autoload cookies\n\nDependencies:\n- Emacs 27.1+ (for transient, project.el, json.el)\n- transient library\n- json.el (built-in)","acceptance_criteria":"## Acceptance Criteria\n\n### Core Functionality\n- [ ] Package loads without errors in Emacs 27.1+\n- [ ] Customization group 'beads' is defined with all user options\n- [ ] Autoload cookies properly set for public commands\n- [ ] bd CLI executable is found and validated\n\n### Process Wrapper Functions\n- [ ] Synchronous bd command execution with JSON parsing\n- [ ] Asynchronous bd command execution with callbacks\n- [ ] Proper error handling for missing bd executable\n- [ ] Proper error handling for invalid JSON responses\n- [ ] Timeout handling for long-running commands\n- [ ] Support for all global flags (--actor, --db, etc.)\n\n### JSON Utilities\n- [ ] Parse bd list/show/ready/blocked output correctly\n- [ ] Handle malformed JSON gracefully\n- [ ] Extract all issue fields (id, title, status, priority, etc.)\n- [ ] Support for dependency tree JSON structure\n\n### Project Integration\n- [ ] Automatically find .beads directory using project.el\n- [ ] Fall back to searching up directory tree if no project\n- [ ] Cache project root for performance\n- [ ] Support multiple projects in same Emacs session\n\n### Error Handling \u0026 Logging\n- [ ] User-friendly error messages displayed in echo area\n- [ ] Optional debug logging to *beads-debug* buffer\n- [ ] Validation of required parameters before command execution\n\n## Test Coverage (ERT)\nTests must live in lisp/test/ directory and provide:\n\n- [ ] **test/beads-process-test.el**\n  - Mock bd command execution with fake responses\n  - Test JSON parsing with valid and invalid input\n  - Test error handling for command failures\n  - Test timeout behavior\n  - Test global flag construction\n\n- [ ] **test/beads-project-test.el**\n  - Test project root detection in various scenarios\n  - Test .beads directory discovery\n  - Test fallback behavior when no project found\n  - Test multiple project handling\n\n- [ ] **test/beads-utils-test.el**\n  - Test utility functions (string parsing, validation, etc.)\n  - Test customization variable handling\n  - Test path construction\n\nAll tests must pass with 'make test' or equivalent command.\nTest coverage should be \u003e80% for core utility functions.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:19:45.091255015+02:00","updated_at":"2025-10-14T22:38:23.855820176+02:00","closed_at":"2025-10-14T22:38:23.855820176+02:00","dependencies":[{"issue_id":"bd-2","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:19:45.092444934+02:00","created_by":"roman"}]}
{"id":"bd-3","title":"beads.el: Implement tabulated-list-mode for issue lists","description":"Create tabulated-list-mode based buffers for displaying issue lists.\n\nFeatures:\n- beads-list-mode derived from tabulated-list-mode\n- Configurable columns: ID, Status, Priority, Type, Title\n- Sortable columns (click header or keyboard shortcuts)\n- Support for bd list, bd ready, bd blocked commands\n- Keyboard navigation (n/p, RET to show details)\n- Mark/unmark functionality for batch operations\n- Refresh capability (g key)\n- Filter/narrow by status, priority, type\n- Colorize status and priority fields\n- Show issue count in mode line\n\nBuffers:\n- *beads-list* - All issues\n- *beads-ready* - Ready work\n- *beads-blocked* - Blocked issues\n\nCommands:\n- beads-list\n- beads-ready  \n- beads-blocked","acceptance_criteria":"## Acceptance Criteria\n\n### Display Functionality\n- [ ] beads-list-mode correctly inherits from tabulated-list-mode\n- [ ] Columns display: ID, Status, Priority, Type, Title\n- [ ] Column widths appropriate and configurable\n- [ ] Header line displays and is interactive\n\n### Data Population\n- [ ] bd list --json output correctly parsed into table entries\n- [ ] bd ready --json output displayed in *beads-ready* buffer\n- [ ] bd blocked --json output displayed in *beads-blocked* buffer\n- [ ] Empty results handled gracefully with message\n\n### Sorting \u0026 Navigation\n- [ ] Click column headers to sort (or keyboard shortcut)\n- [ ] n/p navigate to next/previous issue\n- [ ] RET on issue opens detail view (beads-show)\n- [ ] TAB cycles through sortable columns\n\n### Actions on Items\n- [ ] u key updates current issue (opens transient)\n- [ ] c key closes current issue\n- [ ] s key shows issue details\n- [ ] q key quits buffer\n\n### Mark/Unmark for Batch Operations\n- [ ] m marks current issue\n- [ ] u unmarks current issue\n- [ ] M marks all issues\n- [ ] U unmarks all issues\n- [ ] Marked issues can be closed in batch\n\n### Refresh \u0026 Filter\n- [ ] g key refreshes buffer from bd CLI\n- [ ] Filter by status (/) with completion\n- [ ] Filter by priority with completion\n- [ ] Filter by type with completion\n- [ ] Clear filters\n\n### Visual Styling\n- [ ] Status field colorized (open=blue, in_progress=yellow, blocked=red, closed=gray)\n- [ ] Priority colorized (0=red, 1=orange, 2=default, 3-4=gray)\n- [ ] Mode line shows issue count and filter status\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-list-test.el:\n\n- [ ] **Buffer Creation**\n  - Test buffer creation and mode activation\n  - Test buffer naming\n  - Test switching between list/ready/blocked buffers\n\n- [ ] **Data Parsing**\n  - Mock bd list/ready/blocked JSON responses\n  - Test table entry generation from JSON\n  - Test handling of empty results\n  - Test handling of malformed data\n\n- [ ] **Sorting**\n  - Test sorting by each column\n  - Test ascending/descending order\n  - Test sort stability\n\n- [ ] **Navigation**\n  - Test cursor movement (n/p)\n  - Test RET opening show buffer\n  - Test actions on current item\n\n- [ ] **Mark/Unmark**\n  - Test marking single items\n  - Test marking all items\n  - Test unmarking\n  - Test batch operations on marked items\n\n- [ ] **Filtering**\n  - Test filter by status/priority/type\n  - Test filter combinations\n  - Test filter clearing\n  - Test mode line updates\n\nTest coverage should be \u003e75% for list mode functionality.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:19:53.55050057+02:00","updated_at":"2025-10-14T22:59:40.289542564+02:00","closed_at":"2025-10-14T22:59:40.289542564+02:00","dependencies":[{"issue_id":"bd-3","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:19:53.551685098+02:00","created_by":"roman"},{"issue_id":"bd-3","depends_on_id":"bd-2","type":"blocks","created_at":"2025-10-14T22:21:19.098733822+02:00","created_by":"roman"}]}
{"id":"bd-4","title":"beads.el: Issue detail view with markdown rendering","description":"Implement issue detail display buffer with markdown rendering.\n\nFeatures:\n- beads-show-mode derived from markdown-mode (or special-mode)\n- Display full issue details in formatted layout\n- Sections: metadata header, description, acceptance criteria, design, notes\n- Syntax highlighting for markdown content\n- Read-only by default with edit commands\n- Keybindings for common actions (u: update status, c: close, e: edit field)\n- Show dependency information\n- Display audit trail (created_at, updated_at, actor)\n- Link to related issues (clickable bd-N references)\n\nBuffer naming:\n- *beads-show: bd-N*\n\nCommands:\n- beads-show (prompt for ID or use at-point)\n- beads-show-at-point\n- beads-edit-field (enter edit mode for specific field)\n- beads-update-status\n- beads-close-issue\n\nResearch decisions:\n- markdown-mode vs org-mode vs special-mode with custom fontification\n- How to handle inline editing of fields\n- Displaying metadata alongside markdown","acceptance_criteria":"## Acceptance Criteria\n\n### Display \u0026 Rendering\n- [ ] beads-show-mode correctly defined (derived from markdown-mode or special-mode)\n- [ ] Buffer named *beads-show: bd-N* for issue bd-N\n- [ ] Metadata header displays: ID, Status, Priority, Type, Created/Updated dates\n- [ ] All text fields rendered with proper sections: Description, Acceptance Criteria, Design, Notes\n- [ ] Markdown syntax highlighting works correctly\n- [ ] Empty fields handled gracefully (not displayed or shown as empty)\n\n### Navigation \u0026 Links\n- [ ] bd-N references in text are clickable (jump to that issue)\n- [ ] Links work across all fields (description, notes, etc.)\n- [ ] n/p navigate to next/previous section\n- [ ] q quits and returns to previous buffer\n\n### Actions\n- [ ] u key opens update transient with current values\n- [ ] c key closes issue with reason prompt\n- [ ] e key edits field at point (context-aware)\n- [ ] d key shows dependency tree\n- [ ] g key refreshes issue from bd CLI\n\n### Field Editing\n- [ ] Inline editing for description field\n- [ ] Inline editing for acceptance criteria field\n- [ ] Inline editing for design field\n- [ ] Inline editing for notes field\n- [ ] Edits saved via bd update command\n- [ ] Confirmation before saving changes\n\n### Dependency Display\n- [ ] Dependencies section shows all deps with types\n- [ ] Clickable dependency links\n- [ ] Visual indication of dependency type (blocks, related, etc.)\n\n### Read-only Sections\n- [ ] Metadata header is read-only\n- [ ] Separation between read-only and editable regions clear\n- [ ] Attempt to edit read-only region shows helpful message\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-show-test.el:\n\n- [ ] **Buffer Creation \u0026 Display**\n  - Test buffer creation for valid issue\n  - Test buffer naming\n  - Test error handling for non-existent issue\n  - Test mode activation\n\n- [ ] **Markdown Rendering**\n  - Test markdown syntax highlighting\n  - Test multi-line content rendering\n  - Test code blocks in markdown\n  - Test headers and lists\n\n- [ ] **Link Detection**\n  - Test bd-N reference detection\n  - Test link creation and navigation\n  - Test invalid reference handling\n\n- [ ] **Field Editing**\n  - Mock editing workflow\n  - Test edit mode activation\n  - Test save operation\n  - Test cancel operation\n  - Test validation\n\n- [ ] **Actions**\n  - Test update command integration\n  - Test close command\n  - Test refresh\n  - Test navigation commands\n\n- [ ] **Dependency Display**\n  - Mock dependency data\n  - Test dependency rendering\n  - Test dependency navigation\n\nTest coverage should be \u003e70% for show mode functionality.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:20:07.202138751+02:00","updated_at":"2025-10-14T22:59:40.329075923+02:00","closed_at":"2025-10-14T22:59:40.329075923+02:00","dependencies":[{"issue_id":"bd-4","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:20:07.204456632+02:00","created_by":"roman"},{"issue_id":"bd-4","depends_on_id":"bd-2","type":"blocks","created_at":"2025-10-14T22:21:19.135048519+02:00","created_by":"roman"}]}
{"id":"bd-5","title":"beads.el: Transient menu for bd create command","description":"Implement transient menu for creating new issues.\n\nTransient definition:\n- Prefix: beads-create (bound in main menu)\n- Infixes for all flags:\n  - Type (-t): bug, feature, task, epic, chore\n  - Priority (-p): 0-4 with descriptions\n  - Description (-d): multiline input\n  - Custom ID (--id): for parallel workers\n  - Dependencies (--deps): discovered-from, blocks, etc.\n- Suffix: Execute create command\n\nFeatures:\n- Interactive prompts with completion\n- Validation of required fields (title)\n- Show current values in transient display\n- Preview command before execution\n- Auto-refresh list buffers after creation\n- Support for templates (optional)\n\nIntegration:\n- Call bd create with --json flag\n- Parse response and show created issue\n- Handle errors gracefully","acceptance_criteria":"## Acceptance Criteria\n\n### Transient Menu Definition\n- [ ] beads-create-transient defined using transient-define-prefix\n- [ ] Menu accessible from root transient menu\n- [ ] Menu can also be invoked directly via M-x beads-create\n\n### Infix Arguments\n- [ ] Type selection (-t): bug, feature, task, epic, chore with completion\n- [ ] Priority selection (-p): 0-4 with descriptions (0=Critical, 1=High, etc.)\n- [ ] Description input (-d): multiline text input\n- [ ] Custom ID (--id): optional string input for parallel workers\n- [ ] Dependencies (--deps): format \"type:issue-id\" with completion\n\n### Suffix Actions\n- [ ] Create action constructs correct bd create command\n- [ ] All infix values properly passed to bd CLI\n- [ ] --json flag automatically added\n- [ ] Command executed and JSON response parsed\n\n### User Experience\n- [ ] Current infix values displayed in transient menu\n- [ ] Required fields (title) validated before execution\n- [ ] Help text shown for each option\n- [ ] Preview full command before execution (optional)\n- [ ] Error messages displayed clearly\n- [ ] Success message with created issue ID\n\n### Integration\n- [ ] After successful creation, show created issue\n- [ ] Refresh any open list buffers\n- [ ] Return to appropriate buffer (list or show)\n\n### Optional Features\n- [ ] Template support for common issue types\n- [ ] Recently used values suggested\n- [ ] Duplicate issue detection warning\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-transient-create-test.el:\n\n- [ ] **Transient Definition**\n  - Test prefix command exists\n  - Test infix commands registered\n  - Test suffix commands work\n\n- [ ] **Command Construction**\n  - Test bd create command building with all flags\n  - Test title handling (with spaces, special chars)\n  - Test description multiline handling\n  - Test dependency format parsing\n  - Test global flags inclusion\n\n- [ ] **Validation**\n  - Test missing title error\n  - Test invalid priority error\n  - Test invalid type error\n  - Test invalid dependency format\n\n- [ ] **Execution**\n  - Mock bd create --json response\n  - Test successful creation flow\n  - Test error handling\n  - Test buffer refresh after creation\n\n- [ ] **Integration**\n  - Test show buffer opens after creation\n  - Test list buffer refresh\n  - Test multiple creates in sequence\n\nTest coverage should be \u003e70% for create transient functionality.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:20:19.369611555+02:00","updated_at":"2025-10-14T22:59:40.363364294+02:00","closed_at":"2025-10-14T22:59:40.363364294+02:00","dependencies":[{"issue_id":"bd-5","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:20:19.37098639+02:00","created_by":"roman"},{"issue_id":"bd-5","depends_on_id":"bd-2","type":"blocks","created_at":"2025-10-14T22:21:19.167914252+02:00","created_by":"roman"}]}
{"id":"bd-6","title":"beads.el: Transient menu for bd update command","description":"Implement transient menu for updating existing issues.\n\nTransient definition:\n- Prefix: beads-update (bound in main menu and show buffer)\n- Infixes for all flags:\n  - Status (-s): open, in_progress, blocked, closed\n  - Priority (-p): 0-4\n  - Type (--type): bug, feature, task, epic, chore\n  - Title (--title): change title\n  - Acceptance criteria (--acceptance-criteria): multiline\n  - Design (--design): multiline\n  - Notes (--notes): multiline\n  - Assignee (-a): set assignee\n  - External ref (--external-ref): gh-N, jira-X, etc.\n- Suffix: Execute update command\n\nFeatures:\n- Auto-populate current values from issue\n- Support updating from list buffer (use current item)\n- Support updating from show buffer (use current issue)\n- Show diff of changes before applying\n- Auto-refresh buffers after update\n\nContext-aware:\n- In list buffer: operate on current item or marked items\n- In show buffer: operate on displayed issue\n- Elsewhere: prompt for issue ID","acceptance_criteria":"## Acceptance Criteria\n\n### Transient Menu Definition\n- [ ] beads-update-transient defined using transient-define-prefix\n- [ ] Menu accessible from root transient, list buffer, and show buffer\n- [ ] Can be invoked directly via M-x beads-update\n\n### Context Awareness\n- [ ] In list buffer: operates on current item or marked items\n- [ ] In show buffer: operates on displayed issue\n- [ ] Elsewhere: prompts for issue ID with completion\n- [ ] Auto-populate current values when updating existing issue\n\n### Infix Arguments\n- [ ] Status (-s): open, in_progress, blocked, closed with completion\n- [ ] Priority (-p): 0-4 with descriptions\n- [ ] Type (--type): bug, feature, task, epic, chore\n- [ ] Title (--title): string input\n- [ ] Acceptance criteria (--acceptance-criteria): multiline input\n- [ ] Design (--design): multiline input\n- [ ] Notes (--notes): multiline input\n- [ ] Assignee (-a): string input\n- [ ] External ref (--external-ref): string input (e.g., gh-9, jira-ABC)\n\n### Suffix Actions\n- [ ] Update action constructs correct bd update command\n- [ ] Only changed fields included in command\n- [ ] --json flag automatically added\n- [ ] Command executed and JSON response parsed\n\n### User Experience\n- [ ] Current values pre-populated in transient menu\n- [ ] Show diff of changes before applying (optional)\n- [ ] Help text for each option\n- [ ] Error messages displayed clearly\n- [ ] Success message after update\n\n### Batch Operations\n- [ ] Support updating multiple marked issues in list buffer\n- [ ] Only applicable fields updated in batch (status, priority, type)\n- [ ] Confirmation before batch update\n\n### Integration\n- [ ] Refresh show buffer after update\n- [ ] Refresh list buffers after update\n- [ ] Stay in current buffer or return to appropriate buffer\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-transient-update-test.el:\n\n- [ ] **Transient Definition**\n  - Test prefix command exists\n  - Test infix commands registered\n  - Test suffix commands work\n\n- [ ] **Context Detection**\n  - Test issue ID extraction from list buffer\n  - Test issue ID extraction from show buffer\n  - Test prompt when no context available\n  - Test marked items detection\n\n- [ ] **Current Value Population**\n  - Test fetching current issue values\n  - Test pre-populating transient with current values\n  - Test handling missing optional fields\n\n- [ ] **Command Construction**\n  - Test bd update command with single field\n  - Test bd update command with multiple fields\n  - Test only changed fields included\n  - Test global flags inclusion\n\n- [ ] **Validation**\n  - Test invalid issue ID error\n  - Test invalid status/priority/type values\n  - Test empty required fields\n\n- [ ] **Batch Operations**\n  - Test batch update command construction\n  - Test batch update execution\n  - Test confirmation prompt\n\n- [ ] **Integration**\n  - Mock bd update --json response\n  - Test buffer refresh after update\n  - Test error handling\n  - Test multiple sequential updates\n\nTest coverage should be \u003e70% for update transient functionality.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:20:28.873439416+02:00","updated_at":"2025-10-14T23:33:43.62746304+02:00","closed_at":"2025-10-14T23:33:43.62746304+02:00","dependencies":[{"issue_id":"bd-6","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:20:28.874746672+02:00","created_by":"roman"},{"issue_id":"bd-6","depends_on_id":"bd-2","type":"blocks","created_at":"2025-10-14T22:21:19.200327016+02:00","created_by":"roman"}]}
{"id":"bd-7","title":"beads.el: Transient menus for remaining bd commands","description":"Implement transient menus for all remaining bd commands.\n\nCommands to implement:\n\n1. **bd close** - Close issues\n   - Support multiple issue IDs\n   - Reason flag (--reason)\n   - Batch close from marked items\n\n2. **bd dep** - Dependency submenu\n   - dep add (from-id, to-id, --type)\n   - dep remove (from-id, to-id)\n   - dep tree (issue-id) - maybe special visualization\n   - dep list (issue-id)\n\n3. **bd list** - Enhanced list with filters\n   - Status filter (--status)\n   - Type filter (--type)\n   - Priority filter (--priority)\n   - Format option (--format)\n\n4. **bd stats** - Statistics display\n   - Show in special buffer with formatting\n\n5. **bd export** - Export to JSONL\n   - Output path (-o/--output)\n\n6. **bd import** - Import from JSONL\n   - Input path (-i/--input)\n   - Dry run (--dry-run)\n   - Resolve collisions (--resolve-collisions)\n\n7. **bd init** - Initialize bd\n   - Prefix (--prefix)\n   - DB path (--db)\n\nGlobal flags accessible from all commands:\n- --actor, --db, --json, --no-auto-flush, --no-auto-import","acceptance_criteria":"## Acceptance Criteria\n\nAll remaining bd commands must have transient menu implementations:\n\n### bd close\n- [ ] Transient menu for closing issues\n- [ ] Support single issue ID\n- [ ] Support multiple issue IDs from marked items\n- [ ] Reason flag (--reason) with text input\n- [ ] Confirmation before closing\n- [ ] Refresh buffers after close\n\n### bd dep (Dependency submenu)\n- [ ] Parent transient menu for dependencies\n- [ ] **dep add**: from-id, to-id, --type (blocks, related, parent-child, discovered-from)\n- [ ] **dep remove**: from-id, to-id with confirmation\n- [ ] **dep tree**: issue-id, display in special buffer with tree visualization\n- [ ] **dep list**: issue-id, display in tabulated-list buffer\n- [ ] Context-aware: use current issue from list/show buffer\n\n### bd list (Enhanced filtering)\n- [ ] Transient menu with filter options\n- [ ] Status filter (--status) with multi-select\n- [ ] Type filter (--type) with multi-select\n- [ ] Priority filter (--priority) with multi-select\n- [ ] Format option (--format)\n- [ ] Results displayed in list buffer\n\n### bd stats\n- [ ] Execute bd stats --json\n- [ ] Display in special formatted buffer\n- [ ] Show: total issues, by status, by priority, by type\n- [ ] Visual representation (progress bars, percentages)\n\n### bd export\n- [ ] Transient menu for export\n- [ ] Output path (-o/--output) with file completion\n- [ ] Default to .beads/issues.jsonl\n- [ ] Confirmation if file exists\n- [ ] Success message with exported count\n\n### bd import\n- [ ] Transient menu for import\n- [ ] Input path (-i/--input) with file completion\n- [ ] Dry run flag (--dry-run) toggle\n- [ ] Resolve collisions flag (--resolve-collisions) toggle\n- [ ] Show import preview if dry-run\n- [ ] Confirmation before actual import\n- [ ] Display results (imported, skipped, collisions)\n\n### bd init\n- [ ] Transient menu for initialization\n- [ ] Prefix flag (--prefix) with default suggestions\n- [ ] DB path flag (--db) with file completion\n- [ ] Validation that directory is not already initialized\n- [ ] Success message with created paths\n\n### Global Flags\n- [ ] All menus support --actor flag\n- [ ] All menus support --db flag\n- [ ] All menus support --json flag (automatic)\n- [ ] All menus support --no-auto-flush flag\n- [ ] All menus support --no-auto-import flag\n- [ ] Global flag values persist within session\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-transient-misc-test.el:\n\n- [ ] **bd close**\n  - Test single close command\n  - Test batch close from marked items\n  - Test with/without reason\n  - Test confirmation dialog\n\n- [ ] **bd dep**\n  - Test dep add with all types\n  - Test dep remove with confirmation\n  - Test dep tree visualization\n  - Test dep list display\n  - Test context awareness\n\n- [ ] **bd list filters**\n  - Test filter command construction\n  - Test multi-select filters\n  - Test filter combinations\n  - Test result display\n\n- [ ] **bd stats**\n  - Mock stats JSON response\n  - Test stats buffer creation\n  - Test formatted display\n  - Test visual elements\n\n- [ ] **bd export**\n  - Test export command construction\n  - Test file path handling\n  - Test overwrite confirmation\n  - Mock export execution\n\n- [ ] **bd import**\n  - Test import command with flags\n  - Test dry-run mode\n  - Test collision resolution\n  - Mock import results\n\n- [ ] **bd init**\n  - Test init command construction\n  - Test path validation\n  - Mock initialization\n\n- [ ] **Global Flags**\n  - Test global flag inheritance\n  - Test session persistence\n  - Test flag overrides\n\nTest coverage should be \u003e65% for misc transient functionality.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:20:39.471209401+02:00","updated_at":"2025-10-14T23:47:37.179486422+02:00","closed_at":"2025-10-14T23:47:37.179486422+02:00","dependencies":[{"issue_id":"bd-7","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:20:39.473635907+02:00","created_by":"roman"},{"issue_id":"bd-7","depends_on_id":"bd-2","type":"blocks","created_at":"2025-10-14T22:21:19.23445041+02:00","created_by":"roman"}]}
{"id":"bd-8","title":"beads.el: Root transient menu and keybindings","description":"Implement the main entry point and root transient menu.\n\nRoot transient menu structure:\n- Groups organized logically (View, Create/Edit, Dependencies, Admin)\n- Hierarchy similar to Magit's dispatch menu\n\nMenu layout:\n\n\nKeybindings:\n- Global: M-x beads (or custom binding like C-c b)\n- In code: Jump to issue at point (bd-N references)\n- Context-aware commands in list/show buffers\n\nFeatures:\n- Show current project/database in menu header\n- Persistent settings within session\n- Quick access to most common commands","acceptance_criteria":"## Acceptance Criteria\n\n### Root Transient Menu\n- [ ] beads-dispatch (or beads-main) transient defined\n- [ ] Accessible via M-x beads\n- [ ] Optional global keybinding (e.g., C-c b) documented\n- [ ] Menu organized into logical groups\n\n### Menu Structure\n- [ ] **View group**: list, ready, blocked, show, stats\n- [ ] **Create/Edit group**: create, update, close\n- [ ] **Dependencies group**: dep submenu\n- [ ] **Admin group**: init, export, import\n- [ ] **Settings group**: actor, database path configuration\n\n### Menu Header\n- [ ] Display current project name\n- [ ] Display current database path\n- [ ] Display beads version (from bd --version)\n- [ ] Visual separator between header and commands\n\n### Command Bindings\n- [ ] Single-key bindings for frequent operations\n- [ ] Consistent key scheme (l=list, r=ready, c=create, etc.)\n- [ ] Help text for each command\n- [ ] Submenu indication for nested menus\n\n### Context-Aware Commands\n- [ ] Jump to issue at point (bd-N in any buffer)\n- [ ] Context detection in list/show buffers\n- [ ] Quick actions from current context\n\n### Global Keybindings\n- [ ] M-x beads always works\n- [ ] Optional C-c b prefix (customizable)\n- [ ] Jump to issue at point: C-c b j or similar\n- [ ] Quick create: C-c b c\n- [ ] Quick list: C-c b l\n\n### Integration\n- [ ] All submenus accessible from root menu\n- [ ] Navigation between menus smooth\n- [ ] Quit returns to previous buffer\n- [ ] Command execution closes transient by default\n\n### Customization\n- [ ] User can customize key prefix\n- [ ] User can disable global bindings\n- [ ] User can add custom menu items\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-transient-root-test.el:\n\n- [ ] **Menu Definition**\n  - Test root transient exists\n  - Test all groups defined\n  - Test all commands bound\n\n- [ ] **Menu Display**\n  - Test header generation\n  - Test project name display\n  - Test database path display\n  - Mock bd --version output\n\n- [ ] **Navigation**\n  - Test accessing submenus\n  - Test returning from submenus\n  - Test quit behavior\n\n- [ ] **Context Commands**\n  - Test bd-N reference detection at point\n  - Test jump to issue functionality\n  - Test invalid reference handling\n\n- [ ] **Keybindings**\n  - Test M-x beads invocation\n  - Test global keybinding (if enabled)\n  - Test context-aware bindings\n\n- [ ] **Customization**\n  - Test custom key prefix\n  - Test disabled global bindings\n  - Test custom menu items\n\nTest coverage should be \u003e70% for root transient functionality.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-14T22:20:58.060109854+02:00","updated_at":"2025-10-14T23:23:47.59126376+02:00","closed_at":"2025-10-14T23:23:47.59126376+02:00","dependencies":[{"issue_id":"bd-8","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:20:58.062149196+02:00","created_by":"roman"},{"issue_id":"bd-8","depends_on_id":"bd-2","type":"blocks","created_at":"2025-10-14T22:21:19.264205148+02:00","created_by":"roman"}]}
{"id":"bd-9","title":"beads.el: Testing and documentation","description":"Create tests and documentation for beads.el package.\n\nTesting:\n- Unit tests for utility functions (JSON parsing, process handling)\n- Integration tests for bd command invocations\n- Mock bd responses for testing without real database\n- Test transient menu definitions\n- Test tabulated-list rendering\n- Test buffer state management\n\nDocumentation:\n- README.md for lisp/ directory\n- Installation instructions (MELPA, manual)\n- Quick start guide\n- Configuration examples\n- Keybinding reference\n- Screenshots/demos\n- Comparison with CLI workflow\n- Troubleshooting section\n\nPackage files:\n- beads-pkg.el (package descriptor)\n- Commentary section in beads.el\n- Docstrings for all public functions\n- Customization variable docs","acceptance_criteria":"## Acceptance Criteria\n\n### Test Infrastructure\n- [ ] Makefile or test runner script for running all tests\n- [ ] Command: make test or equivalent runs all ERT tests\n- [ ] Command: make test-coverage generates coverage report\n- [ ] Tests located in lisp/test/ directory\n- [ ] All test files follow naming: *-test.el\n\n### Test Files Required\nAll test files from other issues must exist and pass:\n- [ ] test/beads-process-test.el (from bd-2)\n- [ ] test/beads-project-test.el (from bd-2)\n- [ ] test/beads-utils-test.el (from bd-2)\n- [ ] test/beads-list-test.el (from bd-3)\n- [ ] test/beads-show-test.el (from bd-4)\n- [ ] test/beads-transient-create-test.el (from bd-5)\n- [ ] test/beads-transient-update-test.el (from bd-6)\n- [ ] test/beads-transient-misc-test.el (from bd-7)\n- [ ] test/beads-transient-root-test.el (from bd-8)\n\n### Coverage Targets\n- [ ] Overall test coverage \u003e70%\n- [ ] Core utilities (process, project, utils) \u003e80%\n- [ ] UI components (list, show, transient) \u003e65%\n- [ ] Coverage report generated and reviewed\n\n### Test Quality\n- [ ] All tests pass on Emacs 27.1+\n- [ ] Tests use proper mocking for bd CLI calls\n- [ ] No external dependencies required for tests\n- [ ] Tests run in isolated environments\n- [ ] Fast test execution (\u003c30 seconds total)\n\n### Documentation\n\n#### README.md in lisp/\n- [ ] Project overview and features\n- [ ] Requirements (Emacs version, dependencies)\n- [ ] Installation instructions (MELPA, manual, use-package)\n- [ ] Quick start guide\n- [ ] Configuration examples\n- [ ] Keybinding reference table\n- [ ] Comparison with CLI workflow\n- [ ] Screenshots or GIFs demonstrating usage\n- [ ] Troubleshooting section\n- [ ] Contributing guidelines\n- [ ] License\n\n#### Package Files\n- [ ] beads-pkg.el with proper package descriptor\n- [ ] Package-Version header\n- [ ] Package-Requires specifying dependencies\n- [ ] Keywords for MELPA\n\n#### Code Documentation\n- [ ] Commentary section in beads.el\n- [ ] Docstrings for all public functions (;;; docstring format)\n- [ ] Docstrings for all customization variables\n- [ ] Code comments for complex logic\n- [ ] Examples in docstrings where helpful\n\n#### User Guide\n- [ ] Configuration examples for different workflows\n- [ ] Integration with other packages (projectile, etc.)\n- [ ] Customization options documented\n- [ ] Performance tips\n- [ ] Known limitations\n\n### CI/CD\n- [ ] GitHub Actions workflow for testing (optional but recommended)\n- [ ] Test on multiple Emacs versions (27.1, 28.x, 29.x)\n- [ ] Linting with package-lint or checkdoc\n\n## Test Coverage (ERT)\nTests in lisp/test/beads-meta-test.el:\n\n- [ ] **Test Runner**\n  - Test that all test files load without error\n  - Test that all tests are discovered\n  - Test coverage calculation works\n\n- [ ] **Package Loading**\n  - Test package loads without errors\n  - Test autoloads are correct\n  - Test no compilation warnings\n\n- [ ] **Documentation**\n  - Test README.md exists and is well-formed\n  - Test all public functions have docstrings\n  - Test package metadata is correct\n\nEnsure comprehensive test suite supports long-term maintenance.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-14T22:21:07.332669194+02:00","updated_at":"2025-10-14T23:51:38.725066101+02:00","closed_at":"2025-10-14T23:51:38.725066101+02:00","dependencies":[{"issue_id":"bd-9","depends_on_id":"bd-1","type":"discovered-from","created_at":"2025-10-14T22:21:07.334182019+02:00","created_by":"roman"}]}
